{% extends "base.html" %}
{% block content %}
<div class="links-box col-xs-12 col-sm-8">
    <h1>Manage Users</h1>
    {% if msg %}
    <div class="shrunk-messages">
        {{ msg }}
    </div>
    {% endif %}

    <p>
        shrunk's userclasses are managed by a <b>flag system</b>. Users can have
        any combination of flags assigned to them and each flag will allow
        specific permissions for the user.
    </p>
    <p>
        For example, the flag "A" will give administrator privileges while flag "V"
        will allow the user to create vanity URLs. If a user is assigned "A"
        but not "V", then they will not be able to create vanity URLs depsite
        having admin privileges.
    </p>

    <hr />
    <article class="add-group clearfix">
        <h2>Add User</h2>
        <form class="search" method="POST" action="{{ url_for('user_add') }}" name="add_admin">
            <input id="netid" name="netid" type="text" class="form-control"/> <br />
            <input class="flag" type="checkbox" name="admin" value="admin">A
            <input class="flag" type="checkbox" name="vanity" value="vanity">V <br />
            <input class="shrink-button btn btn-default" type="submit" value="ADD USER" /> <br />
        </form>
    </article>

    <hr />
    <h2>Edit Users</h2>
    {% for user in users %}
    <article class="user-group clearfix">
        <div class="user-info">
            <div class="hover-controls">
                <form method="POST" action="{{ url_for('user_edit') }}">
                    <input type="hidden" id="netid" name="netid" value="{{ user['netid'] }}" />
                    {% if user['flags']['A'] %}
                        <input class="flag" type="checkbox" id="admin" name="admin" checked>A
                    {% else %}
                        <input class="flag" type="checkbox" id="admin" name="admin">A
                    {% endif %}
                    {% if user['flags']['V'] %}
                        <input class="flag" type="checkbox" id="vanity" name="vanity" checked>V
                    {% else %}
                        <input class="flag" type="checkbox" id="vanity" name="vanity">V
                    {% endif %}
                    <input class="shrink-button btn btn-default" type="submit"
                    value="EDIT" />
                </form>
                <form method="POST" action="{{ url_for('user_delete') }}">
                    <input type="hidden" id="netid" name="netid" value="{{ user['netid'] }}" />
                    <input class="shrink-button btn btn-default" type="submit" value="DELETE" />
                </form>
            </div>
            <div class="title">
                {{ user['netid'] }}
            </div>
            {% if user['added_by'] %}
                <div class="added-by">
                    Added by: {{ user['added_by'] }}
                </div>
            {% endif %}
        </div>
    </article>
    {% else %}
        <p>
            There are currently no administrators in the database.
        </p>
    {% endfor %}
</div>
{% endblock %}
